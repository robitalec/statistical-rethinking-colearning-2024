<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Alec L. Robitaille">
<meta name="dcterms.date" content="2024-03-28">
<title>Statistical Rethinking colearning 2024 - Homework 05</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../homework/01-homework.html">Homework</a></li><li class="breadcrumb-item"><a href="../homework/05-homework.html">Homework 05</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistical Rethinking colearning 2024</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/robitalec/statistical-rethinking-colearning-2024" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/01-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 01 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/02-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 02 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/03-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 03 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/04-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 04 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/05-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 05 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/06-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 06 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/07-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 07 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/08-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 08 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/09-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 09 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/10-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 10 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/11-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 11 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/12-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 12 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/13-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 13 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/14-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 14 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/15-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 15 Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/16-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 16 Notes</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Homework</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/01-homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/02-homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/03-homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/04-homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/05-homework.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Homework 05</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/06-homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework 06</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework/targets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">_targets.R</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li>
<a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a>
  <ul class="collapse">
<li><a href="#estimand" id="toc-estimand" class="nav-link" data-scroll-target="#estimand">Estimand</a></li>
  <li><a href="#scientific-model" id="toc-scientific-model" class="nav-link" data-scroll-target="#scientific-model">Scientific model</a></li>
  <li><a href="#analyze-the-data" id="toc-analyze-the-data" class="nav-link" data-scroll-target="#analyze-the-data">Analyze the data</a></li>
  </ul>
</li>
  <li>
<a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a>
  <ul class="collapse">
<li><a href="#estimand-1" id="toc-estimand-1" class="nav-link" data-scroll-target="#estimand-1">Estimand</a></li>
  <li><a href="#scientific-model-1" id="toc-scientific-model-1" class="nav-link" data-scroll-target="#scientific-model-1">Scientific model</a></li>
  <li><a href="#analyze-the-data-1" id="toc-analyze-the-data-1" class="nav-link" data-scroll-target="#analyze-the-data-1">Analyze the data</a></li>
  </ul>
</li>
  <li>
<a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a>
  <ul class="collapse">
<li><a href="#estimand-2" id="toc-estimand-2" class="nav-link" data-scroll-target="#estimand-2">Estimand</a></li>
  <li><a href="#analyze-the-data-2" id="toc-analyze-the-data-2" class="nav-link" data-scroll-target="#analyze-the-data-2">Analyze the data</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/robitalec/statistical-rethinking-colearning-2024/edit/main/homework/05-homework.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/robitalec/statistical-rethinking-colearning-2024/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../homework/01-homework.html">Homework</a></li><li class="breadcrumb-item"><a href="../homework/05-homework.html">Homework 05</a></li></ol></nav><div class="quarto-title">
<h1 class="title">Homework 05</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alec L. Robitaille </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="setup" class="level2"><h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_source.html">tar_source</a></span><span class="op">(</span><span class="st">'R'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="question-1" class="level2"><h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<blockquote class="blockquote">
<p>The data in data(NWOGrants) are outcomes for scientific funding applications for the Netherlands Organization for Scientific Research (NWO) from 2010â€“2012 (see van der Lee and Ellemers doi:10.1073/pnas.1510159112). These data have a structure similar to the UCBAdmit data discussed in Chapter 11 and in lecture. There are applications and each has an associated gender (of the lead researcher). But instead of departments, there are disciplines. Draw a DAG for this sample. Then use the backdoor criterion and a binomial GLM to estimate the TOTAL causal effect of gender on grant awards.</p>
</blockquote>
<section id="estimand" class="level3"><h3 class="anchored" data-anchor-id="estimand">Estimand</h3>
<p>What is the total causal effect of gender on grant awards?</p>
</section><section id="scientific-model" class="level3"><h3 class="anchored" data-anchor-id="scientific-model">Scientific model</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dag</span> <span class="op">&lt;-</span> <span class="fu">dagify</span><span class="op">(</span></span>
<span>    <span class="va">D</span> <span class="op">~</span> <span class="va">G</span>, </span>
<span>    <span class="va">A</span> <span class="op">~</span> <span class="va">G</span> <span class="op">+</span> <span class="va">D</span>,</span>
<span>  coords <span class="op">=</span> <span class="va">coords</span>,</span>
<span>    exposure <span class="op">=</span> <span class="st">'G'</span>,</span>
<span>    outcome <span class="op">=</span> <span class="st">'A'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggdag_status</span><span class="op">(</span><span class="va">dag</span>, seed <span class="op">=</span> <span class="fl">2</span>, layout <span class="op">=</span> <span class="st">'auto'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_dag</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="backdoor-criterion" class="level4"><h4 class="anchored" data-anchor-id="backdoor-criterion">Backdoor criterion</h4>
<ol type="1">
<li>Identify all paths connecting treatment to the outcome, regardless of the direction of arrows</li>
</ol>
<ul>
<li><code>G -&gt; A</code></li>
<li><code>G -&gt; D -&gt; A</code></li>
</ul>
<ol start="2" type="1">
<li>Identify paths with arrows entering the treatment (backdoor). These are non-casual paths, because causal paths exit the treatment (frontdoor).</li>
</ol>
<ul>
<li><del><code>G -&gt; A</code></del></li>
<li><del><code>G -&gt; D -&gt; A</code></del></li>
</ul>
<ol start="3" type="1">
<li>Find adjustment sets that close all backdoor/non-causal paths.</li>
</ol>
<p>There are no backdoor paths entering the treatment (G). There is a direct path from G -&gt; A and an indirect path through D. The adjustment set for the total effect is empty.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggdag_adjustment_set</span><span class="op">(</span><span class="va">dag</span>, effect <span class="op">=</span> <span class="st">'total'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_dag</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="prior-predictive-simulation" class="level4"><h4 class="anchored" data-anchor-id="prior-predictive-simulation">Prior predictive simulation</h4>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">grants</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print priors used</span></span>
<span><span class="fu">tar_read</span><span class="op">(</span><span class="va">h05_q01_brms_prior</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          prior     class coef group resp dpar nlpar   lb   ub source
   normal(0, 1) Intercept                            &lt;NA&gt; &lt;NA&gt;   user
 normal(0, 0.5)         b                            &lt;NA&gt; &lt;NA&gt;   user</code></pre>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load model</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">h05_q01_brms_sample_prior</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h05_q01_brms_sample_prior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: awards | trials(applications) ~ gender 
   Data: h05_q01_brms_data (Number of observations: 18) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     0.00      1.03    -2.06     2.02 1.00     2813     2191
genderm       0.01      0.51    -0.95     0.98 1.00     2877     2447

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Read N draws from the priors and append expected predictions</span></span>
<span><span class="va">n_draws</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">q01_pred_prior</span> <span class="op">&lt;-</span> <span class="va">h05_q01_brms_sample_prior</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">add_predicted_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">grants</span>, ndraws <span class="op">=</span> <span class="va">n_draws</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot prior expectations for acceptance rate and gender</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q01_pred_prior</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_halfeye</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">.prediction</span> <span class="op">/</span> <span class="va">applications</span>, <span class="va">gender</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Predicted acceptance rate'</span>, y <span class="op">=</span> <span class="st">'Gender'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare estimates between gender</span></span>
<span><span class="fu">setDT</span><span class="op">(</span><span class="va">q01_pred_prior</span><span class="op">)</span></span>
<span><span class="va">q01_pred_prior</span><span class="op">[</span>, <span class="va">est</span> <span class="op">:=</span> <span class="va">.prediction</span> <span class="op">/</span> <span class="va">applications</span><span class="op">]</span></span>
<span><span class="va">q01_pred_prior_compare</span> <span class="op">&lt;-</span> <span class="fu">dcast</span><span class="op">(</span></span>
<span>    <span class="va">q01_pred_prior</span>,</span>
<span>    <span class="va">.draw</span> <span class="op">+</span> <span class="va">discipline</span> <span class="op">~</span> <span class="va">gender</span>,</span>
<span>    value.var <span class="op">=</span> <span class="st">'est'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot prior expectations comparing gender</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q01_pred_prior_compare</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density2d_filled</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">f</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'F'</span>, y <span class="op">=</span> <span class="st">'M'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="analyze-the-data" class="level3"><h3 class="anchored" data-anchor-id="analyze-the-data">Analyze the data</h3>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load model</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">h05_q01_brms_sample</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h05_q01_brms_sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: awards | trials(applications) ~ gender 
   Data: h05_q01_brms_data (Number of observations: 18) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -1.73      0.08    -1.89    -1.58 1.00     2099     2415
genderm       0.20      0.10     0.00     0.40 1.00     2437     2009

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_draws</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">q01_pred</span> <span class="op">&lt;-</span> <span class="va">h05_q01_brms_sample</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">add_predicted_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">grants</span>, ndraws <span class="op">=</span> <span class="va">n_draws</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot expectations for acceptance rate and gender</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q01_pred</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_halfeye</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">.prediction</span> <span class="op">/</span> <span class="va">applications</span>, <span class="va">gender</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Predicted acceptance rate'</span>, y <span class="op">=</span> <span class="st">'Gender'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estimated marginal effects</span></span>
<span><span class="va">marg_eff</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">h05_q01_brms_sample</span>, <span class="op">~</span><span class="va">gender</span>, regrid <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="va">marg_eff</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> gender  prob lower.HPD upper.HPD
 f      0.151      0.13     0.169
 m      0.177      0.16     0.196

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">contrast</span><span class="op">(</span><span class="va">marg_eff</span>, method <span class="op">=</span> <span class="st">'pairwise'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate lower.HPD upper.HPD
 f - m      -0.027    -0.054    -9e-04

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
</div>
</section></section><section id="question-2" class="level2"><h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<blockquote class="blockquote">
<p>Now estimate the DIRECT causal effect of gender on grant awards. Use the same DAG as above to justify one or more binomial models. Compute the average direct causal effect of gender, weighting each discipline in proportion to the number of applications in the sample. Refer to the marginal effect example in Lecture 9 for help</p>
</blockquote>
<section id="estimand-1" class="level3"><h3 class="anchored" data-anchor-id="estimand-1">Estimand</h3>
<p>What is the average direct causal effect of gender on grant awards, weighting each discipline in proportion to the number of applications in the sample.</p>
</section><section id="scientific-model-1" class="level3"><h3 class="anchored" data-anchor-id="scientific-model-1">Scientific model</h3>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dag</span> <span class="op">&lt;-</span> <span class="fu">dagify</span><span class="op">(</span></span>
<span>    <span class="va">D</span> <span class="op">~</span> <span class="va">G</span>, </span>
<span>    <span class="va">A</span> <span class="op">~</span> <span class="va">G</span> <span class="op">+</span> <span class="va">D</span>,</span>
<span>  coords <span class="op">=</span> <span class="va">coords</span>,</span>
<span>    exposure <span class="op">=</span> <span class="st">'G'</span>,</span>
<span>    outcome <span class="op">=</span> <span class="st">'A'</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggdag_status</span><span class="op">(</span><span class="va">dag</span>, seed <span class="op">=</span> <span class="fl">2</span>, layout <span class="op">=</span> <span class="st">'auto'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_dag</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="backdoor-criterion-1" class="level4"><h4 class="anchored" data-anchor-id="backdoor-criterion-1">Backdoor criterion</h4>
<ol type="1">
<li>Identify all paths connecting treatment to the outcome, regardless of the direction of arrows</li>
</ol>
<ul>
<li><code>G -&gt; A</code></li>
<li><code>G -&gt; D -&gt; A</code></li>
</ul>
<ol start="2" type="1">
<li>Identify paths with arrows entering the treatment (backdoor). These are non-casual paths, because causal paths exit the treatment (frontdoor).</li>
</ol>
<ul>
<li><del><code>G -&gt; A</code></del></li>
<li><del><code>G -&gt; D -&gt; A</code></del></li>
</ul>
<ol start="3" type="1">
<li>Find adjustment sets that close all backdoor/non-causal paths.</li>
</ol>
<p>There are no backdoor paths entering the treatment (G). There is a direct path from G -&gt; A and an indirect path through D. The adjustment set for the direct effect includes D.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggdag_adjustment_set</span><span class="op">(</span><span class="va">dag</span>, effect <span class="op">=</span> <span class="st">'direct'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_dag</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="prior-predictive-simulation-1" class="level4"><h4 class="anchored" data-anchor-id="prior-predictive-simulation-1">Prior predictive simulation</h4>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load model</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">h05_q02_brms_sample_prior</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h05_q02_brms_sample_prior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: awards | trials(applications) ~ gender * discipline 
   Data: h05_q02_brms_data (Number of observations: 18) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                                     Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                               -0.00      1.05    -2.10     2.05 1.00
genderm                                 -0.01      0.49    -0.95     0.93 1.00
disciplineEarthDlifesciences             0.01      0.49    -0.96     0.94 1.00
disciplineHumanities                    -0.00      0.50    -1.00     0.98 1.00
disciplineInterdisciplinary              0.01      0.49    -0.97     1.00 1.00
disciplineMedicalsciences                0.01      0.50    -0.95     0.99 1.00
disciplinePhysicalsciences              -0.00      0.50    -1.01     1.00 1.00
disciplinePhysics                        0.00      0.49    -0.95     0.95 1.00
disciplineSocialsciences                -0.00      0.50    -0.99     1.00 1.00
disciplineTechnicalsciences              0.00      0.50    -0.99     0.97 1.00
genderm:disciplineEarthDlifesciences    -0.01      0.49    -0.97     0.93 1.00
genderm:disciplineHumanities             0.00      0.50    -0.99     0.97 1.00
genderm:disciplineInterdisciplinary      0.00      0.49    -0.95     0.97 1.00
genderm:disciplineMedicalsciences       -0.00      0.51    -1.00     1.00 1.00
genderm:disciplinePhysicalsciences       0.00      0.49    -0.95     0.97 1.00
genderm:disciplinePhysics                0.00      0.49    -0.97     0.96 1.00
genderm:disciplineSocialsciences        -0.01      0.49    -0.97     0.97 1.00
genderm:disciplineTechnicalsciences     -0.00      0.52    -1.01     1.02 1.00
                                     Bulk_ESS Tail_ESS
Intercept                               10050     3041
genderm                                  9734     3080
disciplineEarthDlifesciences            10434     3091
disciplineHumanities                    10855     3129
disciplineInterdisciplinary              9156     2472
disciplineMedicalsciences                8572     2919
disciplinePhysicalsciences               8718     2633
disciplinePhysics                        8932     2912
disciplineSocialsciences                 9990     2659
disciplineTechnicalsciences              9379     2440
genderm:disciplineEarthDlifesciences     8581     2724
genderm:disciplineHumanities            10051     2918
genderm:disciplineInterdisciplinary     10877     3046
genderm:disciplineMedicalsciences        9390     2485
genderm:disciplinePhysicalsciences       9484     2786
genderm:disciplinePhysics               10029     3119
genderm:disciplineSocialsciences        11004     2580
genderm:disciplineTechnicalsciences     10558     2616

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_draws</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">q02_pred_prior</span> <span class="op">&lt;-</span> <span class="va">h05_q02_brms_sample_prior</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">add_predicted_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">grants</span>, ndraws <span class="op">=</span> <span class="va">n_draws</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot prior expectations for acceptance rate and gender</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q02_pred_prior</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_halfeye</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">.prediction</span> <span class="op">/</span> <span class="va">applications</span>, <span class="va">gender</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Predicted acceptance rate'</span>, y <span class="op">=</span> <span class="st">'Gender'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">discipline</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare estimates between gender</span></span>
<span><span class="fu">setDT</span><span class="op">(</span><span class="va">q02_pred_prior</span><span class="op">)</span></span>
<span><span class="va">q02_pred_prior</span><span class="op">[</span>, <span class="va">est</span> <span class="op">:=</span> <span class="va">.prediction</span> <span class="op">/</span> <span class="va">applications</span><span class="op">]</span></span>
<span><span class="va">q02_pred_prior_compare</span> <span class="op">&lt;-</span> <span class="fu">dcast</span><span class="op">(</span></span>
<span>    <span class="va">q02_pred_prior</span>,</span>
<span>    <span class="va">.draw</span> <span class="op">+</span> <span class="va">discipline</span> <span class="op">~</span> <span class="va">gender</span>,</span>
<span>    value.var <span class="op">=</span> <span class="st">'est'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot prior expectations comparing gender</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q02_pred_prior_compare</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density2d_filled</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">f</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'F'</span>, y <span class="op">=</span> <span class="st">'M'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">discipline</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="analyze-the-data-1" class="level3"><h3 class="anchored" data-anchor-id="analyze-the-data-1">Analyze the data</h3>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_grants</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function() {
  data("NWOGrants")
  
  DT &lt;- data.table(NWOGrants)
  
  DT[, index_gender := .GRP, gender]
  DT[, index_discipline := .GRP, discipline]
  
  DT[, gender := factor(gender)]
  DT[, discipline := factor(discipline)]

  return(DT)
}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load model</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">h05_q02_brms_sample</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h05_q02_brms_sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: awards | trials(applications) ~ gender * discipline 
   Data: h05_q02_brms_data (Number of observations: 18) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
                                     Estimate Est.Error l-95% CI u-95% CI Rhat
Intercept                               -1.40      0.16    -1.72    -1.08 1.00
genderm                                  0.15      0.18    -0.19     0.51 1.00
disciplineEarthDlifesciences            -0.26      0.24    -0.73     0.20 1.00
disciplineHumanities                    -0.09      0.22    -0.52     0.34 1.00
disciplineInterdisciplinary             -0.05      0.26    -0.55     0.45 1.00
disciplineMedicalsciences               -0.55      0.22    -0.99    -0.14 1.00
disciplinePhysicalsciences               0.04      0.29    -0.52     0.62 1.00
disciplinePhysics                        0.11      0.36    -0.61     0.81 1.00
disciplineSocialsciences                -0.58      0.20    -0.99    -0.19 1.00
disciplineTechnicalsciences             -0.06      0.26    -0.58     0.46 1.00
genderm:disciplineEarthDlifesciences     0.32      0.28    -0.23     0.86 1.00
genderm:disciplineHumanities            -0.40      0.27    -0.94     0.12 1.00
genderm:disciplineInterdisciplinary     -0.57      0.32    -1.18     0.07 1.00
genderm:disciplineMedicalsciences        0.30      0.26    -0.20     0.81 1.00
genderm:disciplinePhysicalsciences      -0.20      0.32    -0.81     0.43 1.00
genderm:disciplinePhysics                0.09      0.37    -0.63     0.83 1.00
genderm:disciplineSocialsciences         0.10      0.24    -0.38     0.56 1.00
genderm:disciplineTechnicalsciences     -0.32      0.30    -0.93     0.26 1.00
                                     Bulk_ESS Tail_ESS
Intercept                                3115     3113
genderm                                  3151     2937
disciplineEarthDlifesciences             4294     3094
disciplineHumanities                     3294     3068
disciplineInterdisciplinary              4775     3450
disciplineMedicalsciences                3591     3016
disciplinePhysicalsciences               5005     3153
disciplinePhysics                        5280     2992
disciplineSocialsciences                 3394     2766
disciplineTechnicalsciences              5155     3064
genderm:disciplineEarthDlifesciences     4088     3064
genderm:disciplineHumanities             4441     3109
genderm:disciplineInterdisciplinary      5366     3277
genderm:disciplineMedicalsciences        4154     2744
genderm:disciplinePhysicalsciences       4939     2592
genderm:disciplinePhysics                4894     3107
genderm:disciplineSocialsciences         4204     3396
genderm:disciplineTechnicalsciences      5018     3158

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Read N draws from the priors and append expected predictions</span></span>
<span><span class="va">n_draws</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">q02_pred</span> <span class="op">&lt;-</span> <span class="va">h05_q02_brms_sample</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">add_predicted_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">grants</span>, ndraws <span class="op">=</span> <span class="va">n_draws</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot expectations for acceptance rate and gender</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q02_pred</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_halfeye</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">.prediction</span> <span class="op">/</span> <span class="va">applications</span>, <span class="va">gender</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Predicted acceptance rate'</span>, y <span class="op">=</span> <span class="st">'Gender'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">discipline</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estimated marginal effects</span></span>
<span><span class="va">marg_eff</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span></span>
<span>    <span class="va">h05_q02_brms_sample</span>, </span>
<span>    <span class="op">~</span> <span class="va">gender</span> <span class="op">|</span> <span class="va">discipline</span>,</span>
<span>    regrid <span class="op">=</span> <span class="st">'response'</span></span>
<span><span class="op">)</span></span>
<span><span class="va">marg_eff</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>discipline = Chemical sciences:
 gender  prob lower.HPD upper.HPD
 f      0.198    0.1515     0.252
 m      0.223    0.1647     0.287

discipline = Earth/life sciences:
 gender  prob lower.HPD upper.HPD
 f      0.160    0.1095     0.216
 m      0.235    0.1766     0.301

discipline = Humanities:
 gender  prob lower.HPD upper.HPD
 f      0.184    0.1360     0.238
 m      0.150    0.1077     0.193

discipline = Interdisciplinary:
 gender  prob lower.HPD upper.HPD
 f      0.191    0.1203     0.259
 m      0.134    0.0802     0.199

discipline = Medical sciences:
 gender  prob lower.HPD upper.HPD
 f      0.125    0.0903     0.162
 m      0.183    0.1381     0.231

discipline = Physical sciences:
 gender  prob lower.HPD upper.HPD
 f      0.206    0.1222     0.294
 m      0.197    0.1405     0.266

discipline = Physics:
 gender  prob lower.HPD upper.HPD
 f      0.218    0.1136     0.344
 m      0.263    0.1706     0.371

discipline = Social sciences:
 gender  prob lower.HPD upper.HPD
 f      0.121    0.0943     0.153
 m      0.152    0.1210     0.184

discipline = Technical sciences:
 gender  prob lower.HPD upper.HPD
 f      0.189    0.1205     0.270
 m      0.165    0.1155     0.215

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">contrast</span><span class="op">(</span><span class="va">marg_eff</span>,  method <span class="op">=</span> <span class="st">'pairwise'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>discipline = Chemical sciences:
 contrast estimate lower.HPD upper.HPD
 f - m    -0.02545   -0.0858   0.03182

discipline = Earth/life sciences:
 contrast estimate lower.HPD upper.HPD
 f - m    -0.07495   -0.1496   0.00464

discipline = Humanities:
 contrast estimate lower.HPD upper.HPD
 f - m     0.03418   -0.0368   0.09296

discipline = Interdisciplinary:
 contrast estimate lower.HPD upper.HPD
 f - m     0.05635   -0.0296   0.13891

discipline = Medical sciences:
 contrast estimate lower.HPD upper.HPD
 f - m    -0.05828   -0.1128  -0.00116

discipline = Physical sciences:
 contrast estimate lower.HPD upper.HPD
 f - m     0.00858   -0.0861   0.10683

discipline = Physics:
 contrast estimate lower.HPD upper.HPD
 f - m    -0.04396   -0.1687   0.09336

discipline = Social sciences:
 contrast estimate lower.HPD upper.HPD
 f - m    -0.03054   -0.0732   0.01164

discipline = Technical sciences:
 contrast estimate lower.HPD upper.HPD
 f - m     0.02428   -0.0525   0.11833

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
</div>
</section></section><section id="question-3" class="level2"><h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<blockquote class="blockquote">
<p>OPTIONAL CHALLENGE. The data in data(UFClefties) are the outcomes of 205 Ultimate Fighting Championship (UFC) matches (see ?UFClefties for details). It is widely believed that left-handed fighters (aka â€œSouthpawsâ€) have an advantage against right-handed fighters, and left-handed men are indeed over-represented among fighters (and fencers and tennis players) compared to the general population. Estimate the average advantage, if any, that a left-handed fighter has against right-handed fighters. Based upon your estimate, why do you think left-handers are over-represented among UFC fighters?</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">?</span><span class="va">UFClefties</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>fight: Unique identifier for match</li>
<li>episode: Identifier for UFC episode</li>
<li>fight.in.episode: Order of fight in episode</li>
<li>fighter1.win: 1 if fighter 1 won the match; 0 if fight 2 won</li>
<li>fighter1: Unique identifier for fighter 1</li>
<li>fighter2: Unique identifier for fighter 2</li>
<li>fighter1.lefty: 1 if fighter 1 was left handed; 0 otherwise</li>
<li>fighter2.lefty: 1 if fighter 2 was left handed; 0 otherwise</li>
</ul>
<section id="estimand-2" class="level3"><h3 class="anchored" data-anchor-id="estimand-2">Estimand</h3>
<p>What is the direct effect of handedness on UFC match outcomes?</p>
</section><section id="analyze-the-data-2" class="level3"><h3 class="anchored" data-anchor-id="analyze-the-data-2">Analyze the data</h3>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_ufc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function() {
    data("UFClefties")

    DT &lt;- data.table(UFClefties)

    DT[fighter1.lefty == 1 &amp; fighter2.lefty == 0,
         colnames(DT) := .SD,
         .SDcols = stri_replace(
            colnames(DT),
            regex = c('1', '2'),
            replacement = c('2', '1')
        )]

    DT[, hand_1 := c('L', 'R')[fighter1.lefty + 1]]
    DT[, hand_2 := c('L', 'R')[fighter2.lefty + 1]]
    DT[, hand_pair := factor(paste(hand_1, hand_2, sep = '-'))]

    DT[, .(n_fight = .N, n_win = sum(fighter1.win)), by = hand_pair]
}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">ufc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load model</span></span>
<span><span class="fu">tar_load</span><span class="op">(</span><span class="va">h05_q03_brms_sample</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)
Warning in qs::qread(file = path, use_alt_rep = TRUE): PROMSXP detected,
replacing with NULL (see https://github.com/traversc/qs/issues/93)</code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">h05_q03_brms_sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: binomial 
  Links: mu = logit 
Formula: n_win | trials(n_fight) ~ hand_pair 
   Data: h05_q03_brms_data (Number of observations: 3) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept        0.17      0.17    -0.15     0.49 1.00     3577     2914
hand_pairLMR    -0.19      0.25    -0.70     0.32 1.00     2995     2318
hand_pairRMR    -0.27      0.39    -1.04     0.49 1.00     2336     2590

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_draws</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">q03_pred</span> <span class="op">&lt;-</span> <span class="va">h05_q03_brms_sample</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">add_predicted_draws</span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">ufc</span>, ndraws <span class="op">=</span> <span class="va">n_draws</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot predicted win rate by handedness</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">q03_pred</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">stat_halfeye</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">.prediction</span> <span class="op">/</span> <span class="va">n_fight</span>, <span class="va">hand_pair</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Predicted win rate'</span>, y <span class="op">=</span> <span class="st">'Handedness'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="05-homework_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estimated marginal effects</span></span>
<span><span class="va">marg_eff</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">h05_q03_brms_sample</span>, <span class="op">~</span><span class="va">hand_pair</span>, regrid <span class="op">=</span> <span class="st">'response'</span><span class="op">)</span></span>
<span><span class="va">marg_eff</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> hand_pair  prob lower.HPD upper.HPD
 L-L       0.542     0.461     0.619
 L-R       0.496     0.396     0.607
 R-R       0.475     0.284     0.655

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">contrast</span><span class="op">(</span><span class="va">marg_eff</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast     estimate lower.HPD upper.HPD
 (L-L) effect  0.03835   -0.0419    0.1087
 (L-R) effect -0.00875   -0.1053    0.0883
 (R-R) effect -0.02895   -0.1519    0.0997

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
</div>
<p>Left handed fighters do not appear to have an advantage over right handed fighters.</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/robitalec/statistical-rethinking-colearning-2024/edit/main/homework/05-homework.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/robitalec/statistical-rethinking-colearning-2024/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>